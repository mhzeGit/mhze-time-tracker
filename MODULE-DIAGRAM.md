# Module Dependency Diagram

## Visual Structure

```
???????????????????????????????????????????????????????????????
?                     index.html                              ?
?  (Loads all scripts in correct order)                      ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
        ???????????????????????????????????????
        ?      External Libraries             ?
        ?  • Chart.js (pie & bar charts)      ?
        ???????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                      CORE LAYER                             ?
???????????????????????????????????????????????????????????????
?  app.js                                                     ?
?  • Application state (single source of truth)              ?
?  • Global App object                                       ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                     UTILS LAYER                             ?
???????????????????????????????????????????????????????????????
?  helpers.js                                                 ?
?  • UUID generation                                          ?
?  • Date/time formatting                                     ?
?  • Duration calculations                                    ?
?  • HTML escaping                                            ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                     DATA LAYER                              ?
???????????????????????????????????????????????????????????????
?  data-manager.js          ?  cache-manager.js               ?
?  • Load from JSON         ?  • Save to localStorage         ?
?  • Save to JSON           ?  • Load from localStorage       ?
?  • Data validation        ?  • Cache management             ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                  BUSINESS LOGIC LAYER                       ?
???????????????????????????????????????????????????????????????
?  type-manager.js    ?  entry-manager.js  ?  analytics.js   ?
?  • Add type         ?  • Add entry       ?  • Statistics   ?
?  • Edit type        ?  • Edit entry      ?  • Aggregations ?
?  • Delete type      ?  • Delete entry    ?  • Chart data   ?
?  • Get by ID        ?  • Sort entries    ?  • Calculations ?
?                                                              ?
?  filter-manager.js  ?  sort-manager.js                     ?
?  • Filter by type   ?  • Sort by column                    ?
?  • Filter by date   ?  • Toggle direction                  ?
?  • Clear filters    ?  • Update indicators                 ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                      UI LAYER                               ?
???????????????????????????????????????????????????????????????
?  ui-renderer.js                                             ?
?  • Render summary    • Render types    • Render entries    ?
?  • Update dropdowns  • Coordinate rendering                ?
?                                                              ?
?  chart-renderer.js                                          ?
?  • Render pie chart  • Render time graph                   ?
?  • Chart.js configuration                                   ?
?                                                              ?
?  modal-manager.js          ?  type-modal-manager.js         ?
?  • Task add/edit modal     ?  • Type add/edit modal         ?
?  • Form validation         ?  • Color picker                ?
?  • Duration display        ?  • Form submission             ?
?                                                              ?
?  notifications.js                                           ?
?  • Toast messages    • Success/error/info alerts           ?
???????????????????????????????????????????????????????????????
                              ?
                              ?
???????????????????????????????????????????????????????????????
?                  EVENT & INITIALIZATION                     ?
???????????????????????????????????????????????????????????????
?  event-listeners.js                                         ?
?  • Top bar buttons   • Filter controls  • Sort headers      ?
?  • Modal controls    • View switcher    • Window resize     ?
?                                                              ?
?  init.js                                                    ?
?  • Load cache        • Setup events     • Render UI         ?
?  • Show notification                                        ?
???????????????????????????????????????????????????????????????
```

## Data Flow Example: Adding a New Entry

```
User clicks "Add Task" button
         ?
         ?
??????????????????????????
?  event-listeners.js    ? ? Detects click event
??????????????????????????
         ?
         ?
??????????????????????????
?  modal-manager.js      ? ? Opens modal, shows form
??????????????????????????
         ?
         ?
    User fills form
         ?
         ?
??????????????????????????
?  modal-manager.js      ? ? Validates form data
??????????????????????????
         ?
         ?
??????????????????????????
?  entry-manager.js      ? ? Creates new entry
??????????????????????????
         ?
         ?
??????????????????????????
?  app.js                ? ? Updates App.data.entries
??????????????????????????
         ?
         ?
??????????????????????????
?  cache-manager.js      ? ? Saves to localStorage
??????????????????????????
         ?
         ?
??????????????????????????
?  ui-renderer.js        ? ? Re-renders all UI
??????????????????????????
         ?
         ?????????????????????????????????????????????
         ?                     ?                     ?
  Render summary      Render entries       Render charts
         ?                     ?                     ?
         ?????????????????????????????????????????????
                               ?
                               ?
                    User sees updated UI
```

## Module Communication

### Direct Dependencies
```
init.js
  ? uses
  ?? CacheManager
  ?? DataManager
  ?? EventListeners
  ?? UIRenderer
      ? uses
      ?? ChartRenderer
      ?? FilterManager
      ?? Analytics
      ?? TypeManager
      ?? EntryManager
      ?? Helpers
```

### Shared State
All modules access the global `App` object:
```javascript
App {
  data: { entries[], types[] },
  filters: { typeId, dateStart, dateEnd },
  charts: { pie, timeGraph },
  editingId, editingTypeId,
  currentTimeView, currentFileName
}
```

## Key Principles

### 1. **Layered Architecture**
- Each layer only communicates with adjacent layers
- No UI logic in business modules
- No business logic in UI modules

### 2. **Single Responsibility**
- Each file does one thing well
- Clear, focused purpose
- Easy to test and maintain

### 3. **Loose Coupling**
- Modules are independent
- Can be modified without affecting others
- Global window exposure for cross-module access

### 4. **High Cohesion**
- Related functionality grouped together
- Clear module boundaries
- Logical organization

---

**Legend:**
- `?` = Dependency flow
- `?` = Function call
- `??` = Uses/depends on
- `?` = Next step
